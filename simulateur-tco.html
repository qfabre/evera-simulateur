<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="simulateur-tco.css">
<style>
/* ── Critical Webflow override — inline = guaranteed load ── */
.sim,.sim *,.sim *::before,.sim *::after{box-sizing:border-box!important}
.sim div{margin:0!important;padding:0!important;height:auto!important;min-height:0!important;max-width:none!important}
.sim section{margin:0!important;height:auto!important;min-height:0!important;max-width:none!important}
.sim span,.sim p,.sim a,.sim button,.sim label{margin:0;padding:0}
.sim h1,.sim h2,.sim h3,.sim h4,.sim h5,.sim h6{margin:0!important;padding:0!important}
.sim div,.sim section,.sim span,.sim p,.sim h1,.sim h2,.sim h3,.sim h4,.sim h5,.sim h6,
.sim a,.sim button,.sim input,.sim select,.sim label,.sim table,.sim tr,.sim td,.sim th{
  font-family:inherit!important;line-height:inherit!important;color:inherit;
  border:none;outline:none;background:none;text-decoration:none!important;
  -webkit-font-smoothing:antialiased;letter-spacing:normal!important;text-transform:none!important
}
.sim a{color:inherit!important}
.sim{max-width:820px!important;margin:0 auto!important;padding:40px 20px 80px!important;font-family:'Inter',sans-serif!important;background:#F7F5F3!important;color:#131B1D!important;line-height:1.55!important;display:block!important;position:relative!important}
.sim .svg-sprite{display:none!important;position:absolute!important;width:0!important;height:0!important;overflow:hidden!important}
.sim .evc{background:#FFF!important;border:1px solid #E0E7EB!important;border-radius:12px!important;box-shadow:0 1px 2px rgba(19,27,29,0.04),0 3px 10px rgba(19,27,29,0.05)!important;margin-bottom:16px!important;overflow:hidden!important;padding:24px 24px 20px!important}
.sim .evc-sm{padding:16px 20px!important}
.sim .evc-np{padding:0!important}
.sim .cat-grid{display:grid!important;grid-template-columns:repeat(4,1fr)!important;gap:8px!important;margin-bottom:8px!important}
.sim .moto-grid{display:grid!important;grid-template-columns:repeat(5,1fr)!important;gap:8px!important;margin-bottom:8px!important}
.sim .grid{display:grid!important;gap:14px!important}
.sim .g2{grid-template-columns:1fr 1fr!important}
.sim .g3{grid-template-columns:1fr 1fr 1fr!important}
.sim .detail-grid{display:grid!important;grid-template-columns:1fr 1fr!important;gap:16px!important}
.sim .metric-row{display:grid!important;grid-template-columns:1fr 1fr!important;gap:16px!important}
@media(max-width:640px){.sim .cat-grid{grid-template-columns:1fr 1fr!important}.sim .moto-grid{grid-template-columns:repeat(3,1fr)!important}.sim .g2,.sim .g3,.sim .detail-grid,.sim .metric-row{grid-template-columns:1fr!important}}
.sim .input{display:block!important;width:100%!important;height:44px!important;padding:0 14px!important;border:1.5px solid #E0E7EB!important;border-radius:8px!important;font-size:14px!important;color:#131B1D!important;background:#FFF!important}
.sim .select{display:block!important;width:100%!important;height:44px!important;padding:0 34px 0 14px!important;border:1.5px solid #E0E7EB!important;border-radius:8px!important;font-size:14px!important;color:#131B1D!important;background:#FFF!important;appearance:none!important}
.sim .modal-overlay{display:none!important;position:fixed!important;inset:0!important;z-index:9999!important;align-items:center!important;justify-content:center!important}
.sim .modal-overlay.open{display:flex!important}
.sim .modal{max-width:820px!important}
.sim .results{display:none!important}
.sim .results.visible{display:block!important}
.sim .charts-content{display:none!important}
.sim .charts-content.open{display:block!important}
</style>

<!-- SVG Icon Sprite -->
<svg xmlns="http://www.w3.org/2000/svg" class="svg-sprite">
  <symbol id="ico-car" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M240 120H220.53a4 4 0 0 1-3.74-2.59L194.42 64.47A8 8 0 0 0 187 60H69a8 8 0 0 0-7.43 5.07L39.58 117.4a4 4 0 0 1-3.74 2.6H16"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M16 168h22m180 0h22M64 168h128"/><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="16" y="120" width="224" height="48" rx="8"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="64" cy="192" r="24"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="192" cy="192" r="24"/></symbol>
  <symbol id="ico-fuel" viewBox="0 0 256 256"><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="56" y="56" width="112" height="176" rx="8"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M168 120h28a16 16 0 0 1 16 16v40a16 16 0 0 0 16 16 16 16 0 0 0 16-16V108a8 8 0 0 0-2.34-5.66L216 76"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="56" y1="232" x2="168" y2="232"/><rect fill="none" stroke="currentColor" stroke-width="16" x="88" y="92" width="48" height="36" rx="4"/></symbol>
  <symbol id="ico-bolt" viewBox="0 0 256 256"><polygon fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="152 32 112 136 168 136 104 224 144 120 88 120"/></symbol>
  <symbol id="ico-doc" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M200 224H56a8 8 0 0 1-8-8V40a8 8 0 0 1 8-8h96l56 56v128a8 8 0 0 1-8 8z"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="152 32 152 88 208 88"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="96" y1="136" x2="160" y2="136"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="96" y1="168" x2="160" y2="168"/></symbol>
  <symbol id="ico-bank" viewBox="0 0 256 256"><polygon fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="24 96 128 32 232 96 24 96"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="56" y1="96" x2="56" y2="176"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="104" y1="96" x2="104" y2="176"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="152" y1="96" x2="152" y2="176"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="200" y1="96" x2="200" y2="176"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="32" y1="176" x2="224" y2="176"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="16" y1="208" x2="240" y2="208"/></symbol>
  <symbol id="ico-card" viewBox="0 0 256 256"><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="24" y="56" width="208" height="144" rx="8"/><line stroke="currentColor" stroke-width="16" x1="24" y1="100" x2="232" y2="100"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="68" y1="140" x2="108" y2="140"/></symbol>
  <symbol id="ico-euro" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M192 200a88 88 0 1 1 0-144"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="40" y1="112" x2="160" y2="112"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="40" y1="144" x2="160" y2="144"/></symbol>
  <symbol id="ico-wrench" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M210.68 101.32 168 144 112 88l42.68-42.68a68 68 0 0 0-90.45 90.45L34.34 165.66a8 8 0 0 0 0 11.31l44.69 44.69a8 8 0 0 0 11.31 0l29.89-29.89a68 68 0 0 0 90.45-90.45z"/></symbol>
  <symbol id="ico-shield" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M40 114.79V56a8 8 0 0 1 8-8h160a8 8 0 0 1 8 8v58.77c0 84.18-71.31 112.07-85.54 116.84a7.54 7.54 0 0 1-5 0C111.31 226.86 40 198.97 40 114.79z"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="88 136 112 160 168 104"/></symbol>
  <symbol id="ico-users" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M164.47 195.63a8 8 0 0 0-6.7-12.63H98.23a8 8 0 0 0-6.7 12.63 60 60 0 0 1 72.94 0z"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="128" cy="136" r="32"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="128" cy="128" r="96"/></symbol>
  <symbol id="ico-pin" viewBox="0 0 256 256"><circle fill="none" stroke="currentColor" stroke-width="16" cx="128" cy="104" r="32"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M208 104c0 72-80 128-80 128S48 176 48 104a80 80 0 0 1 160 0z"/></symbol>
  <symbol id="ico-percent" viewBox="0 0 256 256"><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="200" y1="56" x2="56" y2="200"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="76" cy="76" r="28"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="180" cy="180" r="28"/></symbol>
  <symbol id="ico-scales" viewBox="0 0 256 256"><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="128" y1="40" x2="128" y2="216"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="56 72 128 56 200 72"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M24 168 56 72l32 96a36 36 0 0 1-64 0z"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M168 168 200 72l32 96a36 36 0 0 1-64 0z"/></symbol>
  <symbol id="ico-arrow-r" viewBox="0 0 256 256"><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="40" y1="128" x2="216" y2="128"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="184 96 216 128 184 160"/></symbol>
  <symbol id="ico-calendar" viewBox="0 0 256 256"><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="40" y="48" width="176" height="176" rx="8"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="176" y1="24" x2="176" y2="48"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="80" y1="24" x2="80" y2="48"/><line stroke="currentColor" stroke-width="16" x1="40" y1="88" x2="216" y2="88"/></symbol>
  <symbol id="ico-chart" viewBox="0 0 256 256"><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="228" y1="208" x2="28" y2="208"/><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="44" y="104" width="56" height="104"/><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="100" y="40" width="56" height="168"/><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="156" y="72" width="56" height="136"/></symbol>
  <symbol id="ico-check" viewBox="0 0 256 256"><circle fill="none" stroke="currentColor" stroke-width="16" cx="128" cy="128" r="96"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="88 136 112 160 168 104"/></symbol>
  <symbol id="ico-battery" viewBox="0 0 256 256"><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="16" y="72" width="200" height="112" rx="12"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="240" y1="104" x2="240" y2="152"/><rect fill="currentColor" x="44" y="100" width="56" height="56" rx="4" opacity="0.35"/></symbol>
  <symbol id="ico-battery-charge" viewBox="0 0 256 256"><rect fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" x="16" y="72" width="200" height="112" rx="12"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="240" y1="104" x2="240" y2="152"/><polyline fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" points="124 100 108 128 140 128 124 156"/></symbol>
  <symbol id="ico-home" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M152 208V160a8 8 0 0 0-8-8h-32a8 8 0 0 0-8 8v48a8 8 0 0 1-8 8H48a8 8 0 0 1-8-8V115.5a8 8 0 0 1 2.6-5.92l80-72.73a8 8 0 0 1 10.8 0l80 72.73a8 8 0 0 1 2.6 5.92V208a8 8 0 0 1-8 8h-48a8 8 0 0 1-8-8z"/></symbol>
  <symbol id="ico-leaf" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M128 224s-96-32-96-128C32 52 84 16 160 16c80 0 80 64 80 80 0 96-112 128-112 128z"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M128 224c0-68 68-112 92-124"/></symbol>
  <symbol id="ico-truck" viewBox="0 0 256 256"><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M176 80h42.58A8 8 0 0 1 226 85.15l19.14 40.89A8 8 0 0 1 246 129v47a8 8 0 0 1-8 8H224"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="176" y1="184" x2="148" y2="184"/><path fill="none" stroke="currentColor" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" d="M16 184H8a8 8 0 0 1-8-8V72a8 8 0 0 1 8-8h160a8 8 0 0 1 8 8v112"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="188" cy="184" r="24"/><circle fill="none" stroke="currentColor" stroke-width="16" cx="80" cy="184" r="24"/><line stroke="currentColor" stroke-width="16" stroke-linecap="round" x1="176" y1="120" x2="240" y2="120"/></symbol>
</svg>

<div class="sim">

  <!-- ══════ FORM ══════ -->

  <!-- Catégorie de véhicule -->
  <section class="evc">
    <div class="sec-title"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-car"/></svg></span> Catégorie de véhicule</div>
    <div class="cat-grid">
      <div class="cat-card" data-cat="citadine" onclick="setCat(this)">
        <div class="cc-icon"><svg class="ico" width="18" height="18"><use href="#ico-car"/></svg></div><div class="cc-label">Citadine</div>
      </div>
      <div class="cat-card active" data-cat="berline" onclick="setCat(this)">
        <div class="cc-icon"><svg class="ico" width="18" height="18"><use href="#ico-car"/></svg></div><div class="cc-label">Berline</div>
      </div>
      <div class="cat-card" data-cat="suv" onclick="setCat(this)">
        <div class="cc-icon"><svg class="ico" width="18" height="18"><use href="#ico-car"/></svg></div><div class="cc-label">SUV</div>
      </div>
      <div class="cat-card" data-cat="utilitaire" onclick="setCat(this)">
        <div class="cc-icon"><svg class="ico" width="18" height="18"><use href="#ico-truck"/></svg></div><div class="cc-label">Utilitaire</div>
      </div>
    </div>
  </section>

  <!-- Motorisation -->
  <section class="evc">
    <div class="sec-title"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-fuel"/></svg></span> Motorisation actuelle</div>
    <div class="moto-grid">
      <div class="moto-card active" data-type="diesel" onclick="setMoto(this)">
        <div class="mc-icon"><svg class="ico" width="18" height="18"><use href="#ico-fuel"/></svg></div><div class="mc-label">Diesel</div>
      </div>
      <div class="moto-card" data-type="essence" onclick="setMoto(this)">
        <div class="mc-icon"><svg class="ico" width="18" height="18"><use href="#ico-fuel"/></svg></div><div class="mc-label">Essence</div>
      </div>
      <div class="moto-card" data-type="hybride" onclick="setMoto(this)">
        <div class="mc-icon"><svg class="ico" width="18" height="18"><use href="#ico-battery"/></svg></div><div class="mc-label">Hybride</div>
      </div>
      <div class="moto-card" data-type="phev" onclick="setMoto(this)">
        <div class="mc-icon"><svg class="ico" width="18" height="18"><use href="#ico-battery-charge"/></svg></div><div class="mc-label">Hybride recharg.</div>
      </div>
      <div class="moto-card" data-type="electrique" onclick="setMoto(this)">
        <div class="mc-icon"><svg class="ico" width="18" height="18"><use href="#ico-bolt"/></svg></div><div class="mc-label">Électrique</div>
      </div>
    </div>
  </section>

  <!-- Données véhicule -->
  <section class="evc">
    <h3 class="sec-title" style="display:flex !important;align-items:center !important;gap:8px !important;margin-bottom:20px !important"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-doc"/></svg></span> Données du véhicule</h3>

    <span style="display:grid !important;grid-template-columns:1fr 1fr !important;gap:14px !important">
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-card"/></svg> Loyer annuel TTC <span class="tip" data-t="Loyer annuel TTC (LLD, LOA ou crédit-bail)">?</span></span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="loyer" value="7200" min="0" step="100">
          <span class="unit">€ / an</span>
        </span>
      </label>
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-fuel"/></svg> Consommation</span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="conso" value="6.5" min="0" step="0.5">
          <span class="unit" id="consoUnit">L/100km</span>
        </span>
      </label>
    </span>

    <span style="display:grid !important;grid-template-columns:1fr 1fr !important;gap:14px !important;margin-top:14px !important">
      <label style="display:block !important" id="fieldCarb">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-euro"/></svg> Prix carburant TTC</span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="prixCarb" value="1.65" min="0" step="0.05">
          <span class="unit">€ / L</span>
        </span>
      </label>
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-bolt"/></svg> Prix électricité (borne) <span class="tip" data-t="Prix moyen au kWh sur bornes publiques. Le prix domicile (0,21 €/kWh) est appliqué selon votre % de recharge.">?</span></span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="prixElec" value="0.40" min="0" step="0.01">
          <span class="unit">€ / kWh</span>
        </span>
      </label>
    </span>
  </section>

  <!-- Frais annexes -->
  <section class="evc">
    <h3 class="sec-title" style="display:flex !important;align-items:center !important;gap:8px !important;margin-bottom:20px !important"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-wrench"/></svg></span> Frais annexes annuels TTC</h3>
    <span style="display:grid !important;grid-template-columns:1fr 1fr 1fr !important;gap:14px !important">
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-wrench"/></svg> Entretien</span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="fraisEntretien" value="1500" min="0" step="50">
          <span class="unit">€ / an</span>
        </span>
      </label>
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-shield"/></svg> Assurance</span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="fraisAssurance" value="1600" min="0" step="50">
          <span class="unit">€ / an</span>
        </span>
      </label>
      <label style="display:block !important">
        <span class="label" style="display:flex !important;align-items:center !important;gap:5px !important;margin-bottom:6px !important"><svg class="ico" width="18" height="18"><use href="#ico-scales"/></svg> TVS / Fiscalité <span class="tip" data-t="Taxe sur les Véhicules de Société annuelle. Les VE en sont exonérés.">?</span></span>
        <span class="input-wrap" style="display:block !important;position:relative !important">
          <input type="number" class="input has-u" id="fraisTVS" value="1100" min="0" step="50">
          <span class="unit">€ / an</span>
        </span>
      </label>
    </span>
    <span class="frais-summary" style="display:flex !important;align-items:center !important;justify-content:space-between !important;padding:12px 16px !important;background:#EDF5FA !important;border-radius:8px !important;margin-top:12px !important">
      <span class="fs-label">Total frais annexes</span>
      <span class="fs-value" id="fraisTotal">4 200 €/an</span>
    </span>
  </section>

  <!-- Flotte -->
  <section class="evc evc-sm">
    <div class="sec-title"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-users"/></svg></span> Nombre de véhicules</div>
    <div class="fleet-presets">
      <button class="fp active" data-v="1" onclick="setFleet(this)">1</button>
      <button class="fp" data-v="10" onclick="setFleet(this)">10</button>
      <button class="fp" data-v="50" onclick="setFleet(this)">50</button>
      <button class="fp" data-v="100" onclick="setFleet(this)">100</button>
      <button class="fp" data-v="200" onclick="setFleet(this)">200</button>
      <div class="input-wrap fleet-input-wrap">
        <input type="number" class="input fleet-input" id="flotte" value="1" min="1" step="1" oninput="syncFleetBtns()">
      </div>
    </div>
  </section>

  <!-- Kilométrage -->
  <section class="evc">
    <div class="sec-title"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-pin"/></svg></span> Kilométrage annuel</div>
    <div class="slider-group">
      <div class="slider-header">
        <span class="sh-label">Kilométrage total par véhicule</span>
        <span class="sh-value" id="kmTotalVal">25 000 km</span>
      </div>
      <input type="range" class="slider" id="kmTotal" min="5000" max="80000" value="25000" step="1000" oninput="updateKm()">
      <div class="slider-ticks"><span>5 000 km</span><span>80 000 km</span></div>
    </div>
  </section>

  <!-- Recharge -->
  <section class="evc">
    <div class="sec-title"><span class="st-ico"><svg class="ico" width="18" height="18"><use href="#ico-home"/></svg></span> Proportion de recharge</div>
    <div class="slider-group">
      <div class="slider-header">
        <span class="sh-label">Recharge à domicile / entreprise</span>
        <span class="sh-value" id="pctDomicileVal">60%</span>
      </div>
      <input type="range" class="slider" id="pctDomicile" min="0" max="100" value="60" step="5" oninput="updateRecharge()">
      <div class="slider-ticks"><span>0% (tout borne publique)</span><span>100% (tout domicile)</span></div>
    </div>
    <div class="recharge-split">
      <div class="recharge-split-item rs-dom"><div class="rs-pct" id="pctDomicileVal2">60%</div><div class="rs-label">domicile (0,21 €/kWh)</div></div>
      <div class="recharge-split-item rs-borne"><div class="rs-pct" id="pctBorneVal">40%</div><div class="rs-label">bornes publiques</div></div>
    </div>
  </section>

  <!-- CTA -->
  <div class="cta-wrap">
    <button class="btn-calc" onclick="onCalculate()">
      Calculer le TCO <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
    </button>
  </div>

  <!-- ══════ RESULTS ══════ -->
  <div class="results" id="results">

    <!-- Hero -->
    <div class="result-hero">
      <div class="rh-over">RÉSULTAT DE VOTRE SIMULATION TCO</div>
      <div class="rh-heading">En passant à l'électrique, économisez <em id="heroSav">—</em><span id="heroFlotteLabel"> par an</span></div>
      <div class="rh-sub">Le véhicule électrique réduit vos coûts d'énergie, d'entretien et de fiscalité, pour un TCO globalement inférieur.</div>
      <span class="rh-fleet-total" id="heroFleetTotal"></span>
      <div class="rh-boxes">
        <div class="rh-box">
          <div class="rb-tag">Actuel</div>
          <div class="rb-label" id="heroMotoLabel">Diesel</div>
          <div class="rb-val" id="heroActuel">—</div>
          <div class="rb-foot">TCO / véhicule / an</div>
        </div>
        <div class="rh-arrow">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
          <div class="rh-arrow-val" id="heroArrow">—</div>
        </div>
        <div class="rh-box reco">
          <div class="rb-tag">Recommandé</div>
          <div class="rb-label">Électrique</div>
          <div class="rb-val" id="heroElec">—</div>
          <div class="rb-foot">TCO / véhicule / an</div>
        </div>
      </div>
    </div>

    <!-- Calc debug -->
    <div class="calc-debug" id="calcDebug"></div>

    <!-- Detail cards -->
    <div class="detail-grid">
      <section class="evc evc-np detail-card dc-base">
        <div class="dc-head">
          <div class="dc-title"><svg class="ico ico-sm" width="16" height="16"><use href="#ico-fuel"/></svg> Actuel</div>
          <span class="dc-tag dc-tag-base">Actuel</span>
        </div>
        <div class="dc-body">
          <div class="dc-total-val" id="r_a_total">—</div>
          <div class="dr"><span class="dl">Loyer / Location</span><span class="dv" id="r_a_loyer">—</span></div>
          <div class="dr"><span class="dl">Énergie</span><span class="dv" id="r_a_energie">—</span></div>
          <div class="dr"><span class="dl">Entretien</span><span class="dv" id="r_a_entretien">—</span></div>
          <div class="dr"><span class="dl">Assurance</span><span class="dv" id="r_a_assurance">—</span></div>
          <div class="dr"><span class="dl">Fiscalité (TVS)</span><span class="dv" id="r_a_fiscalite">—</span></div>
          <div class="dc-foot"><span class="dl">Coût au km</span><span class="dv" id="r_a_km">—</span></div>
        </div>
      </section>
      <section class="evc evc-np detail-card dc-reco">
        <div class="dc-head">
          <div class="dc-title"><svg class="ico ico-sm" width="16" height="16"><use href="#ico-bolt"/></svg> Électrique</div>
          <span class="dc-tag dc-tag-reco">Recommandé</span>
        </div>
        <div class="dc-body">
          <div class="dc-total-val" id="r_e_total">—</div>
          <div class="dr"><span class="dl">Loyer / Location</span><span class="dv" id="r_e_loyer">—</span></div>
          <div class="dr"><span class="dl">Énergie</span><span class="dv" id="r_e_energie">—</span></div>
          <div class="dr"><span class="dl">Entretien</span><span class="dv" id="r_e_entretien">—</span></div>
          <div class="dr"><span class="dl">Assurance</span><span class="dv" id="r_e_assurance">—</span></div>
          <div class="dr"><span class="dl">Fiscalité (TVS)</span><span class="dv" id="r_e_fiscalite">—</span></div>
          <div class="dc-foot"><span class="dl">Coût au km</span><span class="dv" id="r_e_km">—</span></div>
        </div>
      </section>
    </div>

    <!-- Metrics -->
    <div class="metric-row">
      <div class="metric-box">
        <span class="mb-label">Coût mensuel moyen</span>
        <div class="mb-values">
          <div style="text-align:center"><div class="mb-val v-actuel" id="coutMensuelActuel">—</div><div class="mb-val-label">Actuel</div></div>
          <div style="text-align:center"><div class="mb-val v-elec" id="coutMensuelElec">—</div><div class="mb-val-label">Électrique</div></div>
        </div>
      </div>
      <div class="metric-box">
        <span class="mb-label">Coût au kilomètre</span>
        <div class="mb-values">
          <div style="text-align:center"><div class="mb-val v-actuel" id="coutKmActuel">—</div><div class="mb-val-label">Actuel</div></div>
          <div style="text-align:center"><div class="mb-val v-elec" id="coutKmElec">—</div><div class="mb-val-label">Électrique</div></div>
        </div>
      </div>
    </div>

    <!-- PDF download -->
    <div style="text-align:center;margin-bottom:20px">
      <button class="btn-fleet-outline" onclick="downloadPDF()" style="display:inline-flex !important">
        <svg class="ico" width="18" height="18"><use href="#ico-doc"/></svg> Télécharger le rapport PDF
      </button>
    </div>

    <!-- Charts toggle -->
    <button class="charts-toggle" id="chartsToggle" onclick="toggleCharts()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M6 9l6 6 6-6"/></svg>
      Afficher les graphiques
    </button>
    <div class="charts-content" id="chartsContent">

      <!-- Bar chart -->
      <div class="chart-section">
        <div class="chart-title">Comparaison par poste de coût</div>
        <div class="chart-legend">
          <div class="chart-legend-item"><span class="cl-dot" style="background:#E8943A"></span> Actuel</div>
          <div class="chart-legend-item"><span class="cl-dot" style="background:#1A8A84"></span> Électrique</div>
        </div>
        <div class="chart-bars" id="chartBars"></div>
      </div>

      <!-- Stacked bars -->
      <div class="chart-section">
        <div class="chart-title">Coût total annuel</div>
        <div class="stacked-bars" id="chartStacked"></div>
        <div class="stacked-legend">
          <div class="stacked-legend-item"><span class="sl-dot" style="background:#131B1D"></span> Loyer</div>
          <div class="stacked-legend-item"><span class="sl-dot" style="background:#E8943A"></span> Énergie</div>
          <div class="stacked-legend-item"><span class="sl-dot" style="background:#63768D"></span> Entretien</div>
          <div class="stacked-legend-item"><span class="sl-dot" style="background:#1A8A84"></span> Assurance</div>
          <div class="stacked-legend-item"><span class="sl-dot" style="background:#C4554E"></span> Fiscalité</div>
        </div>
      </div>

      <!-- Donut charts -->
      <div class="chart-section">
        <div class="chart-title">Répartition des coûts</div>
        <div class="donut-row">
          <div class="donut-wrap">
            <div class="donut-label">Actuel</div>
            <div class="donut" id="donutActuel"></div>
            <div class="donut-legend"></div>
          </div>
          <div class="donut-wrap">
            <div class="donut-label">Électrique</div>
            <div class="donut" id="donutElec"></div>
            <div class="donut-legend"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ══════ EVERA FLEET SOLUTIONS ══════ -->
    <div class="sol-section">
      <div class="sol-header">Optimisez vos coûts avec Evera Fleet</div>
      <div class="sol-sub">Evera Fleet vous aide à réduire chaque poste de dépense de votre flotte grâce à des outils intelligents.</div>

      <div class="sol-grid">
        <!-- AEN réduits -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-green"><svg class="ico" width="18" height="18"><use href="#ico-percent"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Avantages en nature réduits</div>
              <div class="sc-amount" id="solAen">—</div>
            </div>
          </div>
          <div class="sc-desc">Grâce au suivi kilométrique automatique, passez du forfait au réel et réduisez les charges sociales sur les AEN.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer gratuitement</button></a>
            <a href="https://evera.co/fleet" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-outline">En savoir plus</button></a>
          </div>
        </div>
        <!-- Électrification -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-green"><svg class="ico" width="18" height="18"><use href="#ico-bolt"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Électrification de votre flotte</div>
              <div class="sc-amount" id="solElec">—</div>
            </div>
          </div>
          <div class="sc-desc">Pilotez votre transition vers l'électrique avec un plan d'électrification sur mesure et un scoring environnemental.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer gratuitement</button></a>
            <a href="https://evera.co/fleet/electrification-esg-rse" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-outline">En savoir plus</button></a>
          </div>
        </div>
        <!-- Énergie -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-amber"><svg class="ico" width="18" height="18"><use href="#ico-fuel"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Énergie optimisée</div>
              <div class="sc-amount" id="solEnergie">—</div>
            </div>
          </div>
          <div class="sc-desc">Optimisez vos sessions de recharge (heures creuses, smart charging) et réduisez votre facture énergie.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer gratuitement</button></a>
          </div>
        </div>
        <!-- Fiscalité -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-red"><svg class="ico" width="18" height="18"><use href="#ico-bank"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Fiscalité et taxes</div>
              <div class="sc-amount" id="solFiscalite">—</div>
            </div>
          </div>
          <div class="sc-desc">Les véhicules électriques sont exonérés de TVS. Evera Fleet automatise vos déclarations fiscales URSSAF.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer gratuitement</button></a>
          </div>
        </div>
      </div>

      <div class="sol-grid sol-grid-3">
        <!-- Entretien -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-blue"><svg class="ico" width="18" height="18"><use href="#ico-wrench"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Entretien proactif</div>
              <div class="sc-amount" id="solEntretien">—</div>
            </div>
          </div>
          <div class="sc-desc">Maintenance prédictive et alertes automatiques pour réduire les coûts d'entretien.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer</button></a>
          </div>
        </div>
        <!-- Assurance -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-dark"><svg class="ico" width="18" height="18"><use href="#ico-shield"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Couverture premium</div>
              <div class="sc-amount" id="solAssurance">—</div>
            </div>
          </div>
          <div class="sc-desc">Négociez de meilleurs tarifs d'assurance flotte grâce à un suivi de conduite détaillé.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer</button></a>
          </div>
        </div>
        <!-- Véhicule -->
        <div class="sol-card">
          <div class="sc-head">
            <div class="sc-icon sc-icon-dark"><svg class="ico" width="18" height="18"><use href="#ico-car"/></svg></div>
            <div class="sc-head-text">
              <div class="sc-title">Gestion de flotte</div>
            </div>
          </div>
          <div class="sc-desc">Centralisez toutes vos données véhicules, conducteurs et dépenses sur une seule plateforme.</div>
          <div class="sc-btns">
            <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration"><button class="sc-btn sc-btn-main">Essayer</button></a>
          </div>
        </div>
      </div>

      <!-- Savings total bar -->
      <div class="savings-bar">
        <div class="sb-title">Économies totales estimées avec Evera Fleet</div>
        <div class="sb-amount" id="savingsTotal">—</div>
        <div class="sb-fleet" id="savingsFleet"></div>
        <div class="sb-chips" id="savingsChips"></div>
      </div>
    </div>

    <!-- Fleet CTA -->
    <div class="fleet-cta">
      <div class="fc-text">
        <div class="fc-text-title">Prêt à optimiser le TCO de votre flotte ?</div>
        <div class="fc-text-desc">Evera Fleet calcule automatiquement le TCO de chaque véhicule et identifie les leviers d'économie.</div>
      </div>
      <div class="fc-btns">
        <a href="https://fleet.evera.co/demo" target="_blank" class="no-decoration">
          <button class="btn-fleet-main">Essai gratuit <svg class="ico" width="18" height="18"><use href="#ico-arrow-r"/></svg></button>
        </a>
        <a href="https://evera.co/fleet/planifiez-votre-demonstration" target="_blank" class="no-decoration">
          <button class="btn-fleet-outline"><svg class="ico" width="18" height="18"><use href="#ico-calendar"/></svg> Planifier une démo</button>
        </a>
      </div>
    </div>

    <div class="new-wrap">
      <button class="btn-new" onclick="newSim()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M1 4v6h6"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
        Nouvelle simulation
      </button>
    </div>
  </div>

  <div class="sim-foot">
    Simulation indicative basée sur des moyennes de marché 2026. Les résultats ne constituent pas un conseil financier.<br>
    Prix domicile : 0,21 €/kWh (heures creuses). TVS : barème 2026. Véhicules électriques exonérés de TVS.
  </div>

  <!-- ══════ MODAL ══════ -->
  <div class="modal-overlay" id="modal">
    <article class="modal" style="max-width:820px !important">

      <aside class="modal-left">
        <div class="ml-badge">Résultats gratuits</div>
        <div class="ml-title">Découvrez le TCO réel de votre flotte</div>
        <div class="ml-savings" id="modalSavValue">—</div>
        <div class="ml-savings-label" id="modalSavLabel">d'économies / an sur votre flotte</div>

        <div class="ml-features">
          <div class="ml-feat">
            <div class="ml-feat-icon"><svg class="ico" width="18" height="18"><use href="#ico-chart"/></svg></div>
            <div class="ml-feat-text">Comparaison <strong>Thermique vs Électrique</strong> poste par poste</div>
          </div>
          <div class="ml-feat">
            <div class="ml-feat-icon"><svg class="ico" width="18" height="18"><use href="#ico-euro"/></svg></div>
            <div class="ml-feat-text">Économies chiffrées sur <strong>5 postes de dépenses</strong></div>
          </div>
          <div class="ml-feat">
            <div class="ml-feat-icon"><svg class="ico" width="18" height="18"><use href="#ico-bolt"/></svg></div>
            <div class="ml-feat-text">Recommandations <strong>d'électrification</strong> personnalisées</div>
          </div>
          <div class="ml-feat">
            <div class="ml-feat-icon"><svg class="ico" width="18" height="18"><use href="#ico-check"/></svg></div>
            <div class="ml-feat-text">Solutions <strong>Evera Fleet</strong> pour optimiser chaque poste</div>
          </div>
        </div>

        <div class="ml-trust">+1 000 entreprises utilisent Evera Fleet</div>
      </aside>

      <div class="modal-right">
        <button class="modal-close" onclick="closeModal()">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6L6 18M6 6l12 12"/></svg>
        </button>

        <div class="mr-title">Accédez à votre analyse TCO</div>
        <div class="mr-subtitle">30 secondes pour accéder à votre rapport complet.</div>

        <!-- Honeypot -->
        <div class="hp-field" aria-hidden="true">
          <label>Website</label>
          <input type="text" id="leadWebsite" tabindex="-1" autocomplete="off">
        </div>

        <div class="modal-row">
          <div class="modal-field">
            <div class="label">Prénom *</div>
            <input type="text" class="input" id="leadPrenom" placeholder="Jean" autocomplete="given-name">
            <div class="field-err" id="errPrenom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span></span></div>
          </div>
          <div class="modal-field">
            <div class="label">Nom *</div>
            <input type="text" class="input" id="leadNom" placeholder="Dupont" autocomplete="family-name">
            <div class="field-err" id="errNom"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span></span></div>
          </div>
        </div>

        <div class="modal-field">
          <div class="label">Email professionnel *</div>
          <input type="email" class="input" id="leadEmail" placeholder="jean@entreprise.com" autocomplete="email">
          <div class="field-err" id="errEmail"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span></span></div>
        </div>

        <div class="modal-row">
          <div class="modal-field">
            <div class="label">Entreprise *</div>
            <input type="text" class="input" id="leadEntreprise" placeholder="Nom de l'entreprise" autocomplete="organization">
            <div class="field-err" id="errEntreprise"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span></span></div>
          </div>
          <div class="modal-field">
            <div class="label">Téléphone</div>
            <input type="tel" class="input" id="leadTel" placeholder="+33 6 12 34 56 78" autocomplete="tel">
          </div>
        </div>

        <button class="btn-modal" id="btnSubmit" onclick="submitLead()">
          Voir mes résultats gratuitement <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <div class="modal-legal">En soumettant, vous acceptez la <a href="https://evera.co/politique-de-confidentialite" target="_blank">politique de confidentialité</a> d'Evera.</div>
      </div>

    </article>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="simulateur-tco.js"></script>
